#!/usr/bin/python3

constants = [
   0x2913260a,
   0x37dbdd6f,
   0x772ca820,
   0xd8f52e67,
   0x99a463b6,
   0x4e6cb8df,
   0x3092c9fd,
   0x925b5044,
   0xb0353f26,
   0xbefdf68b,
   0x11fdc56d,
   0x60174783,
   0x60174783,
   0xd58ed1fb,
   0x828f0319,
   0x197d6960,
   0x197d6960,
   0x46200fa7,
   0x7b45efa7,
   0xe739609f,
   0xfae864d0,
   0x5cb0eb17,
   0x4901e6e6,
   0xa09f827c,
   0x6b79a27c,
   0xcd4228c3,
   0x26808c3,
   0x6e5b79bb,
   0x64308f0a,
   0xe3d30433,
   0xe3d30433,
   0x27c19b98,
   0x31ec8649,
   0x546441df,
   0x546441df,
   0xf57d92d7,
   0xeb52a826,
   0x6af51d4f,
   0x4d1b2e6d,
   0xaee3b4b4,
   0xccbda396,
   0xdb865afb,
   0x1ad725ac,
   0x7c9fabf3,
   0x3d4ee142,
   0xf217366b,
   0x9f176789,
   0x3605cdd0,
   0x3605cdd0,
   0x62a87417,
   0xb5a842f9,
   0x3c1c50f,
   0x3c1c50f,
   0x79394f87,
   0x263980a5,
   0xbd27e6ec,
   0x880206ec,
   0xe9ca8d33,
   0x1ef06d33,
   0x8ae3de2b,
   0x9e92e25c,
   0x5b68a3,
   0xecac6472,
   0x444a0008,
   0x4e74eab9,
   0x70eca64f,
   0x70eca64f,
   0x1205f747,
   0x7db0c96,
   0x877d81bf,
   0x877d81bf,
   0xcb6c1924,
   0xd59703d5,
   0xf80ebf6b,
   0x375f8a1c,
   0x99281063,
   0x59d745b2,
   0xe9f9adb,
   0xf0c5abf9,
   0x528e3240,
   0x70682122,
   0x7f30d887,
   0xbe81a338,
   0x204a297f,
   0x204a297f,
   0x95c1b3f7,
   0x42c1e515,
   0xd9b04b5c,
   0xd9b04b5c,
   0x652f1a3,
   0x5952c085,
   0xa76c429b,
   0xbb1b46cc,
   0x1ce3cd13,
   0x934c8e2,
   0x60d26478,
   0x2bac8478,
   0x8d750abf,
   0xc29aeabf,
   0x2e8e5bb7,
   0x423d5fe8,
   0xa405e62f,
   0xa405e62f,
   0xe7f47d94,
   0xf21f6845,
   0x149723db,
   0x149723db,
   0xb5b074d3,
   0xab858a22,
   0x2b27ff4b,
   0x2b27ff4b,
   0x6f1696b0,
   0x8cf08592,
   0x9bb93cf7,
   0xdb0a07a8,
   0x3cd28def,
   0xfd81c33e,
   0xb24a1867,
   0x94702985,
   0xf638afcc,
   0xf638afcc,
   0x22db5613,
   0x75db24f5,
   0xc3f4a70b,
   0xc3f4a70b,
   0x396c3183,
   0xe66c62a1,
   0x7d5ac8e8,
   0x7d5ac8e8,
   0xa9fd6f2f,
   0xdf234f2f,
   0x4b16c027,
   0x5ec5c458,
   0xc08e4a9f,
   0xacdf466e,
   0x47ce204,
   0xcf570204,
   0x311f884b,
   0x6645684b,
   0xd238d943,
   0xc80dee92,
   0x47b063bb,
   0x47b063bb,
   0x8b9efb20,
   0x95c9e5d1,
   0xb841a167,
   0xb841a167,
   0x595af25f,
   0x1a0a27ae,
   0xced27cd7,
   0xb0f88df5,
   0x12c1143c,
   0x309b031e,
   0x3f63ba83,
   0x7eb48534,
   0xe07d0b7b,
   0xa12c40ca,
   0x55f495f3,
   0x2f4c711,
   0x99e32d58,
   0x99e32d58,
   0xc685d39f,
   0x1985a281,
   0x679f2497,
   0x679f2497,
   0xdd16af0f,
   0x8a16e02d,
   0x21054674,
   0xebdf6674,
   0x4da7ecbb,
   0x82cdccbb,
   0xeec13db3,
   0x27041e4,
   0x6438c82b,
   0x5089c3fa,
   0xa8275f90,
   0xb2524a41,
   0xd4ca05d7,
   0xd4ca05d7,
   0x75e356cf,
   0x6bb86c1e,
   0xeb5ae147,
   0xeb5ae147,
   0x2f4978ac,
   0x3974635d,
   0x5bec1ef3,
   0x9b3ce9a4,
   0xfd056feb,
   0xbdb4a53a,
   0x727cfa63,
   0x54a30b81,
   0xb66b91c8,
   0xd44580aa,
   0xe30e380f,
   0x225f02c0,
   0x84278907,
   0x84278907,
   0xf99f137f,
   0xa69f449d,
   0x3d8daae4,
   0x3d8daae4,
   0x6a30512b,
   0xbd30200d,
   0xb49a223,
   0x1ef8a654,
   0x80c12c9b,
   0x6d12286a,
   0xc4afc400,
   0x8f89e400,
   0xf1526a47,
   0x26784a47,
   0x926bbb3f,
   0xa61abf70,
   0x7e345b7,
   0x7e345b7,
   0x4bd1dd1c,
   0x55fcc7cd,
   0x78748363,
   0x78748363,
   0x198dd45b,
   0xf62e9aa,
   0x8f055ed3,
   0x712b6ff1,
   0xd2f3f638,
   0xf0cde51a,
   0xff969c7f,
   0x3ee76730,
   0xa0afed77,
   0x615f22c6,
   0x162777ef,
   0xf84d890d,
   0x5a160f54,
   0x5a160f54,
   0x86b8b59b,
   0xd9b8847d,
   0x27d20693,
   0x27d20693,
   0x9d49910b,
   0x4a49c229,
   0xe1382870,
   0xe1382870,
   0xddaceb7,
   0x4300aeb7,
   0xaef41faf,
   0xc2a323e0,
   0x246baa27,
   0x10bca5f6,
   0x685a418c,
   0x3334618c,
   0x94fce7d3,
   0x94fce7d3,
   0x361638cb,
   0x2beb4e1a,
   0xab8dc343,
   0xab8dc343,
   0xef7c5aa8,
   0xf9a74559,
   0x1c1f00ef,
   0x1c1f00ef,
   0xbd3851e7,
   0x7de78736,
   0x32afdc5f,
   0x14d5ed7d,
   0x769e73c4,
   0x947862a6,
   0xa3411a0b,
   0xe291e4bc,
   0x445a6b03,
   0x509a052,
   0xb9d1f57b,
   0x66d22699,
   0xfdc08ce0,
   0xfdc08ce0,
   0x2a633327,
   0x7d630209,
   0xcb7c841f,
   0xcb7c841f,
   0x40f40e97,
   0x2d450a66,
   0x84e2a5fc,
   0x4fbcc5fc,
   0xb1854c43,
   0xe6ab2c43,
   0x529e9d3b,
   0x664da16c,
   0xc81627b3,
   0xb4672382,
   0xc04bf18,
   0x162fa9c9,
   0x38a7655f,
   0x38a7655f,
   0xd9c0b657,
   0xcf95cba6,
   0x4f3840cf,
   0x4f3840cf,
   0x9326d834,
   0x9d51c2e5,
   0xbfc97e7b,
   0xff1a492c,
   0x60e2cf73,
   0x219204c2,
   0xd65a59eb,
   0xb8806b09,
   0x1a48f150,
   0x3822e032,
   0x46eb9797,
   0x99eb6679,
   0xe804e88f,
   0xe804e88f,
   0x5d7c7307,
   0xa7ca425,
   0xa16b0a6c,
   0xa16b0a6c,
   0xce0db0b3,
   0x210d7f95,
   0x6f2701ab,
   0x82d605dc,
   0xe49e8c23,
   0xd0ef87f2,
   0x288d2388,
   0xf3674388,
   0x552fc9cf,
   0x8a55a9cf,
   0xf6491ac7,
   0x9f81ef8,
   0x6bc0a53f,
   0x6bc0a53f,
   0xafaf3ca4,
   0xb9da2755,
   0xdc51e2eb,
   0xdc51e2eb,
   0x7d6b33e3,
   0x73404932,
   0xf2e2be5b,
   0xd508cf79,
   0x36d155c0,
   0x54ab44a2,
   0x6373fc07,
   0xa2c4c6b8,
   0x48d4cff,
   0xc53c824e,
   0x7a04d777,
   0x5c2ae895,
   0xbdf36edc,
   0xbdf36edc,
   0xea961523,
   0x3d95e405,
   0x8baf661b,
   0x8baf661b,
   0x126f093,
   0xae2721b1,
   0x451587f8,
   0xfefa7f8,
   0x71b82e3f,
   0xa6de0e3f,
   0x12d17f37,
   0x26808368,
   0x884909af,
   0x749a057e,
   0xcc37a114,
   0x9711c114,
   0xf8da475b,
   0xf8da475b,
   0x99f39853,
   0x8fc8ada2,
   0xf6b22cb,
   0xf6b22cb,
   0x5359ba30,
   0x5d84a4e1,
   0x7ffc6077,
   0x7ffc6077,
   0x2115b16f,
   0xe1c4e6be,
   0x968d3be7,
   0x78b34d05,
   0xda7bd34c,
   0xf855c22e,
   0x71e7993,
   0x466f4444,
   0xa837ca8b,
   0xa837ca8b,
   0x1daf5503,
   0xcaaf8621,
   0x619dec68,
   0x619dec68,
   0x8e4092af,
   0xe1406191,
   0x2f59e3a7,
   0x2f59e3a7,
   0xa4d16e1f,
   0x912269ee,
   0xe8c00584,
   0xb39a2584,
   0x1562abcb,
   0x4a888bcb,
   0xb67bfcc3,
   0xca2b00f4,
   0x2bf3873b,
   0x1844830a,
   0x6fe21ea0,
   0x7a0d0951,
   0x9c84c4e7,
   0x9c84c4e7,
   0x3d9e15df,
   0x33732b2e,
   0xb315a057,
   0xb315a057,
   0xf70437bc,
   0x14de269e,
   0x23a6de03,
   0x62f7a8b4,
   0xc4c02efb,
   0x856f644a,
   0x3a37b973,
   0x1c5dca91,
   0x7e2650d8,
   0x9c003fba,
   0xaac8f71f,
   0xfdc8c601,
   0x4be24817,
   0x4be24817,
   0xc159d28f,
   0x6e5a03ad,
   0x54869f4,
   0x54869f4,
   0x31eb103b,
   0x84eadf1d,
   0xd3046133,
   0xe6b36564,
   0x487bebab,
   0x34cce77a,
   0x8c6a8310,
   0x5744a310,
   0xb90d2957,
   0xee330957,
   0x5a267a4f,
   0x4ffb8f9e,
   0xcf9e04c7,
   0xcf9e04c7,
   0x138c9c2c,
   0x1db786dd,
   0x402f4273,
   0x402f4273,
   0xe148936b,
   0xd71da8ba,
   0x56c01de3,
   0x38e62f01,
   0x9aaeb548,
   0xb888a42a,
   0xc7515b8f,
   0x6a22640,
   0x686aac87,
   0x2919e1d6,
   0xdde236ff,
   0xc008481d,
   0x21d0ce64,
   0x21d0ce64,
   0x4e7374ab,
   0xa173438d,
   0xef8cc5a3,
   0xef8cc5a3,
   0x6504501b,
   0x12048139,
   0xa8f2e780,
   0x73cd0780,
   0xd5958dc7,
   0xabb6dc7,
   0x76aedebf,
   0x8a5de2f0,
   0xec266937,
   0xd8776506,
   0x3015009c,
   0xfaef209c,
   0x5cb7a6e3,
   0x5cb7a6e3,
   0xfdd0f7db,
   0xf3a60d2a,
   0x73488253,
   0x73488253,
   0xb73719b8,
   0xc1620469,
   0xe3d9bfff,
   0x232a8ab0,
   0x84f310f7,
   0x45a24646,
   0xfa6a9b6f,
   0xdc90ac8d,
   0x3e5932d4,
   0x5c3321b6,
   0x6afbd91b,
   0xaa4ca3cc,
   0xc152a13,
   0xc152a13,
   0x818cb48b,
   0x2e8ce5a9,
   0xc57b4bf0,
   0xc57b4bf0,
   0xf21df237,
   0x451dc119,
   0x9337432f,
   0x9337432f,
   0x8aecda7,
   0xf4ffc976,
   0x4c9d650c,
   0x1777850c,
   0x79400b53,
   0xae65eb53,
   0x1a595c4b,
   0x2e08607c,
   0x8fd0e6c3,
   0x8fd0e6c3,
   0xd3bf7e28,
   0xddea68d9,
   0x62246f,
   0x62246f,
   0xa17b7567,
   0x97508ab6,
   0x16f2ffdf,
   0x16f2ffdf,
   0x5ae19744,
   0x78bb8626,
   0x87843d8b,
   0xc6d5083c,
   0x289d8e83,
   0xe94cc3d2,
   0x9e1518fb,
   0x803b2a19,
   0xe203b060,
   0xffdd9f42,
   0xea656a7,
   0x61a62589,
   0xafbfa79f,
   0xafbfa79f,
   0x25373217,
   0xd2376335,
   0x6925c97c,
   0x6925c97c,
   0x95c86fc3,
   0xcaee4fc3,
   0x36e1c0bb,
   0x4a90c4ec,
   0xac594b33,
   0x98aa4702,
   0xf047e298,
   0xbb220298,
   0x1cea88df,
   0x521068df,
   0xbe03d9d7,
   0xb3d8ef26,
   0x337b644f,
   0x337b644f,
   0x7769fbb4,
   0x8194e665,
   0xa40ca1fb,
   0xa40ca1fb,
   0x4525f2f3,
   0x3afb0842,
   0xba9d7d6b,
   0x9cc38e89,
   0xfe8c14d0,
   0x1c6603b2,
   0x2b2ebb17,
   0x6a7f85c8,
   0xcc480c0f,
   0x8cf7415e,
   0x41bf9687,
   0xeebfc7a5,
   0x85ae2dec,
   0x85ae2dec,
   0xb250d433,
   0x550a315,
   0x536a252b,
   0x536a252b,
   0xc8e1afa3,
   0x75e1e0c1,
   0xcd04708,
   0xd7aa6708,
   0x3972ed4f,
   0x6e98cd4f,
   0xda8c3e47,
   0xee3b4278,
   0x5003c8bf,
   0x3c54c48e,
   0x93f26024,
   0x5ecc8024,
   0xc095066b,
   0xc095066b,
   0x61ae5763,
   0x57836cb2,
   0xd725e1db,
   0xd725e1db,
   0x1b147940,
   0x253f63f1,
   0x47b71f87,
   0x8707ea38,
   0xe8d0707f,
   0xa97fa5ce,
   0x5e47faf7,
   0x406e0c15,
   0xa236925c,
   0xc010813e,
   0xced938a3,
   0xe2a0354,
   0x6ff2899b,
   0x6ff2899b,
   0xe56a1413,
   0x926a4531,
   0x2958ab78,
   0x2958ab78,
   0x55fb51bf,
   0xa8fb20a1,
   0xf714a2b7,
   0xac3a6e8,
   0x6c8c2d2f,
   0x58dd28fe,
   0xb07ac494,
   0x7b54e494,
   0xdd1d6adb,
   0x12434adb,
   0x7e36bbd3,
   0x91e5c004,
   0xf3ae464b,
   0xf3ae464b,
   0x379cddb0,
   0x41c7c861,
   0x643f83f7,
   0x643f83f7,
   0x558d4ef,
   0xfb2dea3e,
   0x7ad05f67,
   0x7ad05f67,
   0xbebef6cc,
   0xdc98e5ae,
   0xeb619d13,
   0x2ab267c4,
   0x8c7aee0b,
   0x4d2a235a,
   0x1f27883,
   0xe41889a1,
   0x45e10fe8,
   0x45e10fe8,
   0x7283b62f,
   0xc5838511,
   0x139d0727,
   0x139d0727,
   0x8914919f,
   0x3614c2bd,
   0xcd032904,
   0xcd032904,
   0xf9a5cf4b,
   0x2ecbaf4b,
   0x9abf2043,
   0xae6e2474,
   0x1036aabb,
   0xfc87a68a,
   0x54254220,
   0x1eff6220,
   0x80c7e867,
   0xb5edc867,
   0x21e1395f,
   0x17b64eae,
   0x9758c3d7,
   0x9758c3d7,
   0xdb475b3c,
   0xe57245ed,
   0x7ea0183,
   0x7ea0183,
   0xa903527b,
   0x69b287ca,
   0x1e7adcf3,
   0xa0ee11,
   0x62697458,
   0x8043633a,
   0x8f0c1a9f,
   0xce5ce550,
   0x30256b97,
   0xf0d4a0e6,
   0xa59cf60f,
   0x529d272d,
   0xe98b8d74,
   0xe98b8d74,
   0x162e33bb,
   0x692e029d,
   0xb74784b3,
   0xb74784b3,
   0x2cbf0f2b,
   0xd9bf4049,
   0x70ada690,
   0x3b87c690,
   0x9d504cd7,
   0xd2762cd7,
   0x3e699dcf,
   0x5218a200,
   0xb3e12847,
   0xa0322416,
   0xf7cfbfac,
   0x1faaa5d,
   0x247265f3,
   0x247265f3,
   0xc58bb6eb,
   0xbb60cc3a,
   0x3b034163,
   0x3b034163,
   0x7ef1d8c8,
   0x891cc379,
   0xab947f0f,
   0xeae549c0,
   0x4cadd007,
   0xd5d0556,
   0xc2255a7f,
   0xa44b6b9d,
   0x613f1e4,
   0x23ede0c6,
   0x32b6982b,
   0x720762dc,
   0xd3cfe923,
   0xd3cfe923,
   0x4947739b,
   0xf647a4b9,
   0x8d360b00,
   0x8d360b00,
   0xb9d8b147,
   0xcd88029,
   0x5af2023f,
   0x6ea10670,
   0xd0698cb7,
   0xbcba8886,
   0x1458241c,
   0xdf32441c,
   0x40faca63,
   0x7620aa63,
   0xe2141b5b,
   0xf5c31f8c,
   0x578ba5d3,
   0x578ba5d3,
   0x9b7a3d38,
   0xa5a527e9,
   0xc81ce37f,
   0xc81ce37f,
   0x69363477,
   0x5f0b49c6,
   0xdeadbeef
]

def pattern(el):
   return (el + ((el << 4 ^ el >> 5))) & 0xffffffff

def decrypt():
   el1 = 0x57415343
   el2 = 0x41484148
   final = ""

   for constant in constants[::-1]:
      aux = (el1 + (pattern(el2) ^ constant)) & 0xffffffff
      el1 = el2
      el2 = aux

   final += ("0x" + format(el1, '08x') + '-' + "0x" + format(el2, '08x'))
   return final

def test(testKey):
   keyStrings = testKey.split('-')

   el1 = int(keyStrings[0], 16)
   el2 = int(keyStrings[1], 16)

   for index, constant in enumerate(constants):
      if index & 1 == 0:
         el2 = (el2 - ((el1 * 0x10 ^ el1 >> 5) + el1 ^ constant)) & 0xffffffff
      else:
         el1 = (el1 - ((el2 * 0x10 ^ el2 >> 5) + el2 ^ constant)) & 0xffffffff

   assert(el1 == 0x57415343), "Not passed"
   assert(el2 == 0x41484148), "Not passed"

   return 'Passed'

key = decrypt()

if test(key) == 'Passed':
   key = key.replace('0x', '')
   print("Key:", key)